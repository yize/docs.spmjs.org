<!DOCTYPE HTML>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta name="generator" content="nico 0.4.2">
    <meta name="theme" content="spm 0.1">
    <title>关于Grunt，从一个简单的配置开始！</title>
    <link rel="stylesheet" href="../static/one.css" />
    <link rel="stylesheet" href="../static/syntax.css" />
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-38943643-2']);
      _gaq.push(['_trackPageview']);
      _gaq.push(['_trackPageLoadTime']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = 'https://ssl.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </head>
  <body>
    <div class="navigation" role="navigation">
      <div class="container">
        <a class="home" href="../">SPM</a>
        <div class="menu">
          <a href="./">贡献文档</a>
          <a href="../en/">Documentation</a>
          <a href="../api/">API</a>
          <a href="../cli/">Manual</a>
        </div>
      </div>
    </div>
    <div class="mainbody">
<div class="hentry">
  <h1 class="entry-title">关于Grunt，从一个简单的配置开始！</h1>
  <div class="entry-toc">
    <h3>Table of Contents</h3>
    <ul><li><a href="#简介">简介</a></li><li><a href="#安装">安装</a></li><li><a href="#传说中简单的配置t-t">传说中简单的配置T-T</a></li></ul>
  </div>

  <div class="entry-content"><p>玩儿转grunt，需要了解的知识稍微多一点，这里仅以一个简单的配置介绍grunt，希望能让你尽快的认识她。</p>

<p>进一步的了解，请移步官网：<a href="http://gruntjs.com/" title="Grunt">Grunt</a></p>
<h2 id="简介">简介</h2>
<p>Q：Grunt为何物？</p>

<p>A：一个专为JavaScript提供的构建工具。</p>

<p>Q：啥是构建工具？</p>

<p>A：在项目部署上线前，通常要将源文件压缩，合并，并拷贝到bch或trunk中。
在将js模块化后，又多了一个分析，提取业务代码中所依赖模块的工作。
解决这一系列繁重工作的自动化工具，称之为构建工具。</p>

<p>Q：grunt是如何工作的？</p>

<p>A：刚刚接触grunt，举个例子可能不太恰当，但应该可以让你先比较准确的认识她。
就好像一个万能工厂（grunt），只负责执行任务（Task），不关心每个任务到底都干了什么。
这些任务比如：</p>

<ul>
<li><p>clean:删除临时文件</p></li>
<li><p>uglify:压缩</p></li>
<li><p>qunit:测试</p></li>
<li><p>concat:合并</p></li>
</ul>

<p>任务流程可能是这样的：</p>

<ul>
<li><p>task:clean</p></li>
<li><p>task:uglify</p></li>
<li><p>task:qunit</p></li>
<li><p>task:concat</p></li>
</ul>
<h2 id="安装">安装</h2>
<p>前提是你已经安装了<code>nodejs</code>和<code>npm</code>。 你可以在 <a href="http://nodejs.org/">nodejs.org</a> 下载安装包安装，也可以通过包管理器（比如在 Mac 上用 homebrew，同时推荐在 Mac 上用 homebrew）。</p>

<p><strong>安装grunt CLI</strong></p>
<pre>npm install -g grunt-cli
</pre>
<p>按照官方的说法，<code>grunt-cli</code>只是为了在同一台机器上安装不同的<code>grunt</code>版本，那么咱们先不去管他。</p>

<p><strong>在项目中使用grunt</strong></p>

<p>首先需要往项目里添加两个文件：<code>package.json</code>和<code>Gruntfile.js</code></p>

<ul>
<li>package.json:该文件用来为npm存放项目配置的元数据，与grunt关系最大的配置在devDependencies中。</li>
</ul>
<pre>&quot;devDependencies&quot;: {
    &quot;grunt&quot;: &quot;~0.4.1&quot;,
    &quot;grunt-cmd-transport&quot;: &quot;~0.2.0&quot;,
    &quot;grunt-cmd-concat&quot;: &quot;~0.2.0&quot;,
    &quot;grunt-contrib-uglify&quot;: &quot;~0.2.0&quot;,
    &quot;grunt-contrib-clean&quot;: &quot;~0.4.0&quot;
}
</pre>
<ul>
<li>Gruntfile.js:注意G的大写，这个文件就是<code>grunt</code>的配置了，其中详细定义了每个任务的细节和执行任务的顺序等。</li>
</ul>

<p><strong>安装grunt</strong></p>

<p>在命令行进入项目所在目录，键入如下命令即可，<code>npm</code>会根据<code>devDependencies</code>中的配置，将需要的<code>grunt</code>及其插件下载到你的项目目录中。</p>
<pre>npm install grunt --save-dev
</pre><h2 id="传说中简单的配置t-t">传说中简单的配置T-T</h2>
<p>终于到了简单配置环节，就从<code>Gruntfile.js</code>入手，一点点的认识<code>grunt</code>。</p>

<p>一个几乎是<code>Gruntfile.js</code>通用的写法：</p>
<pre>module.exports = function(grunt) {
  grunt.initConfig({
    pkg: grunt.file.readJSON(&#39;package.json&#39;);
  });
};
</pre>
<p>由于篇幅关系，这里只简单说下。<code>grunt</code>配置的主体都在<code>grunt.initConfig</code>中</p>

<p><code>pkg: grunt.file.readJSON(&#39;package.json&#39;)</code>是为了以后在其它任务（task）中方便读取<code>package.json</code>已经定义好的值。</p>

<p>下面我们来了解下任务（task）：</p>
<pre>transport: {
    dialog: {
        files : [
            {
                src : &#39;*&#39;,
                dest : &#39;.build&#47;styles&#47;component&#47;dialog&#47;src&#39;
            }
        ]
    }
}
</pre>
<p><code>transport</code>就是一个任务（task），她是这次<code>spm2</code>所提供的一系列<code>grunt</code>构建插件的其中一个，该插件主要负责提取模块中的依赖，
并为每个模块设置<code>模块ID</code>。<code>dialog</code>是任务的其中一个目标（Target），<code>files</code>中定义了要对哪些文件执行该任务（src），
以及执行任务后，生成的文件放在什么地方(dest)。</p>

<p>下一个任务是合并(concat)：</p>
<pre>concat: {
    dialog: {
        files: {
            &quot;dist&#47;styles&#47;component&#47;dialog&#47;src&#47;dialog.js&quot;: [&quot;.build&#47;styles&#47;component&#47;dialog&#47;src&#47;dialog.js&quot;]
        }
    }
}
</pre>
<p><code>concat</code>的内容是合并依赖的模块，有很多需要设置的地方，因为本文档目的只是介绍<code>grunt</code>，
所以这里简单说，该配置采用了另外一种<code>src</code>和<code>dest</code>的写法。相信大家只要理解了任务（task）和目标（target）后应该很好理解。</p>

<p>最后，加载<code>grunt</code>需要的插件：</p>
<pre>grunt.loadNpmTasks(&#39;grunt-cmd-transport&#39;);
grunt.loadNpmTasks(&#39;grunt-cmd-concat&#39;);
</pre>
<p>还要告诉grunt该怎么执行这些任务：</p>
<pre>grunt.registerTask(&#39;build&#39;, [&#39;transport&#39;, &#39;concat&#39;]);
</pre>
<p>完整的<code>Gruntfile.js</code>：</p>
<pre>module.exports = function(grunt) {
    grunt.initConfig({
        pkg: grunt.file.readJSON(&#39;package.json&#39;),

        transport: {
            dialog: {
                files : [
                    {
                        src : &#39;*&#39;,
                        dest : &#39;.build&#47;styles&#47;component&#47;dialog&#47;src&#39;
                    }
                ]
            }
        },
        concat: {
            dialog: {
                files: {
                    &quot;dist&#47;styles&#47;component&#47;dialog&#47;src&#47;dialog.js&quot;: [&quot;.build&#47;styles&#47;component&#47;dialog&#47;src&#47;dialog.js&quot;]
                }
            }
        }
    });

    grunt.loadNpmTasks(&#39;grunt-cmd-transport&#39;);
    grunt.loadNpmTasks(&#39;grunt-cmd-concat&#39;);

    grunt.registerTask(&#39;build&#39;, [&#39;transport&#39;, &#39;concat&#39;]);
};

</pre>
<p>最后的最后，进入项目所在目录，命令行输入：</p>
<pre>grunt build
</pre>
<p>一切顺利的话，你就可以看到变化了！</p>
</div>
  <div class="entry-meta">
    <time class="updated" datetime="2013-04-18T07:09:00.000Z">2013-04-18</time>
  </div>
</div>

<div class="sidebar">
  <h2 class="sidebar-title">Documentation</h2>
  <ul>
    <li><a href="./build-with-grunt">使用 grunt 构建</a></li>
    <li><a href="./cmd-grunt-build">如何使用Grunt构建一个中型项目？</a></li>
    <li class="active"><a href="./simple-grunt">关于Grunt，从一个简单的配置开始！</a></li>
    <li><a href="./spm-chaos-build">使用 Spm2 构建业务模块的个人经验</a></li>
  </ul>
</div>

    </div>
    <div class="footer">
      <p class="copyright">powered by <a href="http://lab.lepture.com/nico/">nico</a> 0.4.2</p>
    </div>
    <script src="http://static.alipayobjects.com/seajs/1.2.1/sea.js" data-main="../static/one.js"></script>
    <div class="github"><a class="github-link" href="https://github.com/spmjs/spm2">Fork me on GitHub</a></div>
  </body>
</html>